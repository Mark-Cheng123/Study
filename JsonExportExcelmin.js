/**
 * Created by kin on 2017/4/27.
 *
 * josn导出excel
 * mail：cuikangjie_90h@126.com
 */
!function(){"use static";function e(e){this.fileName=e.fileName||"download",this.datas=e.datas,this.workbook={SheetNames:[],Sheets:{}}}e.prototype.instance=function(){var e=this,t=e.workbook;e.datas.forEach(function(r,n){var a=r.sheetHeader||null,s=r.sheetData,i=r.sheetName||"sheet"+(n+1),o=r.sheetFilter||null,r=e.changeData(s,o);a&&r.unshift(a);var l=e.sheet_from_array_of_arrays(r);l["!merges"]=[],t.SheetNames.push(i),t.Sheets[i]=l});var r=XLSX.write(t,{bookType:"xlsx",bookSST:!1,type:"binary"});e.saveAs(new Blob([e.s2ab(r)],{type:"application/octet-stream"}),e.fileName+".xlsx")},e.prototype.changeData=function(e,t){var e=e,t=t,r=[];return void 0===e[0][0]?function(){t?function(){e.forEach(function(e){var n=[];t.forEach(function(t){n.push(e[t])}),r.push(n)})}():function(){e.forEach(function(e){var t=Object.keys(e),n=[];t.forEach(function(t){n.push(e[t])}),r.push(n)})}()}():function(){r=e}(),r},e.prototype.sheet_from_array_of_arrays=function(e){for(var t=this,r={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},a=0;a!=e.length;++a)for(var s=0;s!=e[a].length;++s){n.s.r>a&&(n.s.r=a),n.s.c>s&&(n.s.c=s),n.e.r<a&&(n.e.r=a),n.e.c<s&&(n.e.c=s);var i={v:e[a][s]};if(null!=i.v){var o=XLSX.utils.encode_cell({c:s,r:a});"number"==typeof i.v?i.t="n":"boolean"==typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=XLSX.SSF._table[14],i.v=t.datenum(i.v)):i.t="s",r[o]=i}}return n.s.c<1e7&&(r["!ref"]=XLSX.utils.encode_range(n)),r},e.prototype.s2ab=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t},e.prototype.datenum=function(e,t){return t&&(e+=1462),(Date.parse(e)-new Date(Date.UTC(1899,11,30)))/864e5},e.prototype.saveExcel=function(){this.instance()},e.prototype.saveAs="undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,r=function(){return e.URL||e.webkitURL||e},n=e.URL||e.webkitURL||e,a=t.createElementNS("http://www.w3.org/1999/xhtml","a"),s=!e.externalHost&&"download"in a,i=e.webkitRequestFileSystem,o=e.requestFileSystem||i||e.mozRequestFileSystem,l=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},f=0,c=[],h=function(){for(var e=c.length;e--;){var t=c[e];"string"==typeof t?n.revokeObjectURL(t):t.remove()}c.length=0},u=function(e,t,r){t=[].concat(t);for(var n=t.length;n--;){var a=e["on"+t[n]];if("function"==typeof a)try{a.call(e,r||e)}catch(e){l(e)}}},d=function(n,l){var h,d,p,g=this,m=n.type,E=!1,B=function(){var e=r().createObjectURL(n);return c.push(e),e},b=function(){u(g,"writestart progress write writeend".split(" "))},S=function(){if(!E&&h||(h=B()),!d){if(navigator.userAgent.match(/7\.[\d\s\.]+Safari/)&&void 0!==window.FileReader&&n.size<=157286400){var e=new window.FileReader;return e.readAsDataURL(n),e.onloadend=function(){var r=t.createElement("iframe");r.src=e.result,r.style.display="none",t.body.appendChild(r),b()},g.readyState=g.DONE,void(g.savedAs=g.SAVEDASUNKNOWN)}return window.open(h,"_blank"),g.readyState=g.DONE,g.savedAs=g.SAVEDASBLOB,void b()}d.location.href=h},v=function(e){return function(){if(g.readyState!==g.DONE)return e.apply(this,arguments)}},C={create:!0,exclusive:!1};if(g.readyState=g.INIT,l||(l="download"),s){h=B(),t=e.document,a=t.createElementNS("http://www.w3.org/1999/xhtml","a"),a.href=h,a.download=l;var T=t.createEvent("MouseEvents");return T.ini
